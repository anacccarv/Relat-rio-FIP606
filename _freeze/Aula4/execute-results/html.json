{
  "hash": "370300cc5e336eb7cde2bd4a0a203fa2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Aula4\"\nformat: html\neditor: visual\nmessage: false\nwarning: false\n---\n\n\n# Bibliotecas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(datapasta)\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(ggthemes)\nlibrary(gsheet)\n```\n:::\n\n\n# Importação de dados\n\nUso do pacote **datapasta** para importar dados (vetores, tabelas) para dentro do R:\n\nCopiar dados da internet -\\> Addins -\\> ***paste as tribble***\n\nSite: <https://escritacientifica.sc.usp.br/estatisticas/estatisticas-por-paises/>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvisitas <- tibble::tribble(\n             ~V1,              ~V2, ~V3,\n              1L,        \"Uruguay\",  1L,\n              2L,    \"Timor-Leste\",  1L,\n              3L,      \"Singapore\",  1L,\n              4L,         \"Poland\",  1L,\n              5L,       \"Pakistan\",  1L,\n              6L,       \"Malaysia\",  1L,\n              7L,          \"Italy\",  1L,\n              8L,          \"India\",  1L,\n              9L,        \"Finland\",  1L,\n             10L,          \"Egypt\",  1L,\n             11L,          \"China\",  1L,\n             12L,     \"Cape Verde\",  1L,\n             13L,        \"Bolivia\",  1L,\n             14L,        \"Austria\",  1L,\n             15L,      \"Argentina\",  1L,\n             16L,           \"Peru\",  2L,\n             17L,       \"Paraguay\",  2L,\n             18L,          \"Chile\",  2L,\n             19L,         \"France\",  3L,\n             20L,        \"Ecuador\",  3L,\n             21L,    \"Netherlands\",  4L,\n             22L, \"United Kingdom\",  5L,\n             23L,        \"Hungary\",  5L,\n             24L,        \"Germany\",  5L,\n             25L,       \"Colombia\",  8L,\n             26L,      \"(not set)\", 12L,\n             27L,          \"Spain\", 16L,\n             28L,         \"Angola\", 19L,\n             29L,  \"United States\", 23L,\n             30L,       \"Portugal\", 33L,\n             31L,     \"Mozambique\", 43L,\n            32L, \"Brazil\", 4303L\n             )\n```\n:::\n\n\n**pak** é um pacote que instala pacotes de outros repositórios além do CRAN\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(\"pak\")\n#pak::pkg_install(\"Icens\")\n#pak::pkg_install(\"emdelponte/r4pde\")\n```\n:::\n\n\n# Importação dos dados\n\nConjunto de dados do site R4PDE (\"https://r4pde.net/temporal-fitting\")\n\n\n::: {.cell}\n\n```{.r .cell-code}\npepper <- \n  tribble(\n   ~t,  ~`1`,  ~`2`,  ~`3`,\n   0,  0.08, 0.001, 0.001,\n   7,  0.13,  0.01, 0.001,\n  14,  0.78,  0.09,  0.01,\n  21,  0.92,  0.25,  0.05,\n  28,  0.99,   0.8,  0.18,\n  35, 0.995,  0.98,  0.34,\n  42, 0.999,  0.99,  0.48,\n  49, 0.999, 0.999,  0.74\n  )\n```\n:::\n\n\n## Mudando o formato da tabela\n\nPara permitir a visualização dos dados através do ggplot é importante que os dados estejam no formato correto. A função ***pivot_longer*** permite passar uma tabela que está no formato largo para o formato longo. De igual modo, a função ***pivot_wider*** permite transformar a tabela do formato longo para formato largo.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npepper1 <- pepper |> \n  pivot_longer(2:4,\n               names_to = \"epidemic\",\n               values_to = \"inc\")\n```\n:::\n\n\n## Visualização dos dados\n\nAgora com os dados transformados é possível visualizar no **ggplot**.\n\nVamos utilizar a função ***annotate*** para colocar informações no gráfico (etiquetas, equações...).\n\nComo já temos os nº das linhas dentro do próprio gráfico não precisa da legenda, por isso **legend.position = \"none\",** para tirar a legenda.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npepper1 |> \n  ggplot(aes(t, inc, color = epidemic))+\n  geom_point()+\n  geom_line()+\n  annotate(geom = \"text\", x = 12.5, y = 0.80, label = 1)+\n  annotate(geom = \"text\", x = 26, y = 0.80, label = 2)+\n  annotate(geom = \"text\", x = 41, y = 0.50, label = 3)+\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](Aula4_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n# Tabela de contingência\n\n## Importação dos dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncr <- read_csv(\"https://raw.githubusercontent.com/emdelponte/paper-coffee-rust-Ethiopia/master/data/survey_clean.csv\")\n```\n:::\n\n\n## Esquematizando a tabela\n\nVai fazer uma contagem de uma váriavel categórica (quantas ocorrências tem) através da função ***count***. Função interessante para fazer um sumário de variáveis categóricas de forma rápida.\n\nTambém podemos usar a função tabyl do pacote **janitor** para fazer a contagem - cruzando as variaveis (ex: zone e region) temos a tabela de contigência.\n\nAs **tabelas de contingência** de frequências relativas mostram que porcentagem dos dados se encaixa em cada categoria.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncr |> \n  count(region, zone)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 9 × 3\n  region zone             n\n  <chr>  <chr>        <int>\n1 Oromia Bale            30\n2 Oromia Ilu AbaBora     45\n3 Oromia Jimma           45\n4 Oromia West Wellega    45\n5 SNNPR  Bench Maji      45\n6 SNNPR  Gedio           45\n7 SNNPR  Keffa           45\n8 SNNPR  Sheka           45\n9 SNNPR  Sidama          60\n```\n\n\n:::\n\n```{.r .cell-code}\ncr |> \n  tabyl(zone, region)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         zone Oromia SNNPR\n         Bale     30     0\n   Bench Maji      0    45\n        Gedio      0    45\n  Ilu AbaBora     45     0\n        Jimma     45     0\n        Keffa      0    45\n        Sheka      0    45\n       Sidama      0    60\n West Wellega     45     0\n```\n\n\n:::\n\n```{.r .cell-code}\ncr |> \n  tabyl(cultivar, region)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n cultivar Oromia SNNPR\n Improved     23    60\n    Local     50    66\n  Mixture     92   114\n```\n\n\n:::\n\n```{.r .cell-code}\ncr |> \n  tabyl(cultivar, farm_management) #formato largo\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n cultivar Intensive Minimal Moderate Unmanaged\n Improved        83       0        0         0\n    Local         0      10        4       102\n  Mixture        82      59       65         0\n```\n\n\n:::\n\n```{.r .cell-code}\n  #formato longo, estes que usaremos para fazer gráficos com o ggplot:\n\ncr2 <- cr |> \n  count(farm_management, cultivar)\n```\n:::\n\n\n## Visualização dos dados com ggplot\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncr2 |> \n    ggplot(aes(cultivar, n, fill = farm_management, label = n))+\n  geom_col(position = \"dodge2\")+\n  scale_fill_canva()+\n  theme_bw()+\n  theme(strip.text.x = element_blank(),\n      legend.position = \"top\")+\n    geom_text(position = position_dodge(width = 0.9))+\n  facet_wrap(~cultivar, scale = \"free_x\")\n```\n\n::: {.cell-output-display}\n![](Aula4_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n## \n\n\n::: {.cell}\n\n```{.r .cell-code}\nmg <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1aID5Dh6PlBVCKzU1j7k-WA6zuWQWE2NhtWEgdJtt5iA/edit?usp=sharing\")\n\n# Com as barras podemos ver o valor médio\nmg |> \n  group_by(trat) |>\n  summarise(mean_comp = mean(comp)) |> \n  ggplot(aes(trat, mean_comp))+\n  geom_col(fill = \"steelblue\", width = 0.5)\n```\n\n::: {.cell-output-display}\n![](Aula4_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#Com o jitter podemos ver a dispersão dos dados já que cada ponto é referente a uma observação.  \nmg |> \n  ggplot(aes(trat, comp))+\n  geom_jitter(width = 0.1)\n```\n\n::: {.cell-output-display}\n![](Aula4_files/figure-html/unnamed-chunk-10-2.png){width=672}\n:::\n\n```{.r .cell-code}\nmg |> \n  group_by(trat) |>\n  summarise(mean_comp = mean(comp),\n            sd_comp = sd(comp)) |> \n  ggplot(aes(trat, mean_comp))+\n  #geom_col(fill = \"steelblue\", width = 0.5)+\n  geom_point(size = 3)+\n  ylim(4, 20)+\n  geom_errorbar(aes(ymin = mean_comp - sd_comp,\n                    ymax = mean_comp + sd_comp),\n                width = 0.05)+\n  annotate(geom = \"text\",\n           x = 1, y = 17.5,\n           label = \"*\")\n```\n\n::: {.cell-output-display}\n![](Aula4_files/figure-html/unnamed-chunk-10-3.png){width=672}\n:::\n\n```{.r .cell-code}\n# quando é grafico de contagem de elementos tem que começar do 0. Nesse caso o y começou do 5 pq é para dar noçao melhor dos valores. Se for com o geom_col tem que começar do 0.\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}