{
  "hash": "5ffda8fc394c226d6067446444a60502",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Teste T e ANOVA\"\nformat: html\neditor: visual\nmessage: false\nwarning: false\n---\n\n\n# Aula 6\n\n## Bibliotecas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gsheet)\nlibrary(tidyverse)\nlibrary(report)\nlibrary(emmeans)\nlibrary(estimability)\nlibrary(see)\n```\n:::\n\n\n## Inferencial\n\nNesta aula, consideramos o alfa = 0,05.\n\n# Teste T\n\nPara análises com dois grupos, com normalidade garantida, usa-se normalmente o teste T.\n\n### Dois grupos independentes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmg <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=983033137\")\n```\n:::\n\n\n#### Visualização\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmg |> \n  ggplot(aes(trat, comp))+\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nHipótese científica: a suplementação de Mg reduz o tamanho da lesão. Hipótese estatística: H0 = as médias não diferem entre os tratamentos.\n\nVisualmente: Parece que tem um efeito da suplementação de magnésio reduzindo a redução da lesão. Indica que o Mg tem um efeito de indução de resistência na planta.\n\n\\*A diferença entre as medianas dá o tamanho desse efeito.\n\nPara dois grupos independentes, com normalidade garantida, usa-se normalmente o teste T. É independente porque são dois grupos medidos individualmente (10 plantas para trat control e 10 plantas para Mg2). \\* Se tivesse avaliações em diferentes tempos na mesma planta, seria dependente, pois a resposta seria dependente da planta.\n\nO box indica normalidade, de acordo com a simetria e dá uma ideia de variancia, por isso, para conjuntos com n \\> ou = 8, o boxplot pode ser bom para viasualizar e fazer a estatística inferencial.\n\n*Observação: o boxplot para conjuntos com n \\> ou = a 8 é bom para visualização e fazer a estatística inferencial (dá noção de normalidade, de acordo com a simetria, e da uma ideia de variância).*\n\n#### Teste T\n\nFunção que roda o teste T: `t.test`\n\nPara o t.test precisa que os dados estejam no formato largo (a função pede os dados (tratamentos) em colunas separadas).\n\nTambém precisa verificar as premissas: homogeneidade de variâncias e normalidade (Shapiro-wilk test).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmg2 <- mg |> \n  pivot_wider(names_from = trat,\n              values_from = comp)\n\nteste1 <- t.test(mg2$control, mg2$Mg2)\n```\n:::\n\n\nAssummindo que o test T atende as premissas, como o p-valor foi muito menor que 0,05, pode-se rejeitar a hipótese nula (H0). Ou seja, existe um efeito de indução de resistência.\n\nSe o intervalo de confiança não inclui o 0, dá diferença.\n\n#### Teste de normalidade\n\nPode ser feito visualmente, mas existe um teste que avalia a normalidade: shapiro.test. No shapiro test a H0 = normalidade. Se p-value for maior do que 0,05, não rejeita H0, ou seja, assume normalidade. Se o p-valor for menor que 0,05, rejeita H0, então assume que não apresenta normalidade.\n\nComo para os dois tratamentos foi maior 0,05, assume normalidade para os tratamentos.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(mg2$control)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  mg2$control\nW = 0.93886, p-value = 0.5404\n```\n\n\n:::\n\n```{.r .cell-code}\nhist(mg2$control)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(mg2$Mg2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  mg2$Mg2\nW = 0.97269, p-value = 0.9146\n```\n\n\n:::\n\n```{.r .cell-code}\nhist(mg2$Mg2)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n:::\n\n\n*Normalmente variáveis numéricas contínuas tendem a apresentar normalidade*.\n\nOutra forma de verificar a normalidade:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqqnorm(mg2$control)\nqqline(mg2$control)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n#### Teste de variância\n\nH0 = as variâncias são homogêneas.\n\nSe p-value for maior do que 0,05, não rejeita H0, ou seja, assume que as variâncias são homogêneas (homocedasticidade). Se o p-valor for menor que 0,05, rejeita H0, então assume que as variâncias são heterogêneas (heterocedasticidade).\n\nComo valor p é maior que 0,05, assume que são homogêneas.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvar.test(mg2$control, mg2$Mg2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tF test to compare two variances\n\ndata:  mg2$control and mg2$Mg2\nF = 0.67654, num df = 9, denom df = 9, p-value = 0.5698\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.1680428 2.7237436\nsample estimates:\nratio of variances \n         0.6765394 \n```\n\n\n:::\n:::\n\n\nComo as variâncias são homogêneas e a normalidade são atendidas, pode usar o teste T normalmente (tipico caso de análise paramétrica).\n\nCaso a variância fosse heterogênea, poderia utilizar o teste T, porém deve informar que as variâncias são heterogêneas:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(mg2$control, mg2$Mg2,\n       var.equal = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  mg2$control and mg2$Mg2\nt = 8.1549, df = 17.354, p-value = 2.423e-07\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n 3.825607 6.490393\nsample estimates:\nmean of x mean of y \n   15.678    10.520 \n```\n\n\n:::\n:::\n\n\n#### Uso da função report\n\nO report cria um \"textinnho\" sobre o teste T que pode ser utilizado para justificar a estatística.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreport(teste1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nEffect sizes were labelled following Cohen's (1988) recommendations.\n\nThe Welch Two Sample t-test testing the difference between mg2$control and\nmg2$Mg2 (mean of x = 15.68, mean of y = 10.52) suggests that the effect is\npositive, statistically significant, and large (difference = 5.16, 95% CI\n[3.83, 6.49], t(17.35) = 8.15, p < .001; Cohen's d = 3.65, 95% CI [2.14, 5.12])\n```\n\n\n:::\n:::\n\n\n### Dois grupos dependentes\n\nDependência: exemplo: mesmo avaliador em tempos diferentes, ou avaliação com escala e sem escala feita pelo mesmo avaliador em momentos diferentes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nescala <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1729131173\")\n```\n:::\n\n\nComo são dois grupos (avaliação com escala e sem escala), pode usar o Teste T novamente, todavia deve indicar o argumento de que é pareado.\n\n#### Visualização\n\n\n::: {.cell}\n\n```{.r .cell-code}\nescala |> \n  ggplot(aes(assessment, acuracia))+\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n#### Teste T\n\n\n::: {.cell}\n\n```{.r .cell-code}\nescala2 <- escala |> \n  select(assessment, rater, acuracia) |> \n  pivot_wider(names_from = assessment,\n              values_from = acuracia)\n\nt.test(escala2$Aided1, escala2$Unaided,\n       var.equal = FALSE,\n       paired = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPaired t-test\n\ndata:  escala2$Aided1 and escala2$Unaided\nt = 4.4214, df = 9, p-value = 0.001668\nalternative hypothesis: true mean difference is not equal to 0\n95 percent confidence interval:\n 0.1147647 0.3552353\nsample estimates:\nmean difference \n          0.235 \n```\n\n\n:::\n:::\n\n\np-value \\< 0,05, por isso, rejeita H0: ou seja há um efeito do uso da escala diagramática aumentando a acurácia dos avaliadores. Como o intervalo de confiança não inclui 0 (varia de 0,113 até 0,252), indica que há diferença significativa.\n\n#### Normalidade\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(escala2$Unaided)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  escala2$Unaided\nW = 0.7748, p-value = 0.007155\n```\n\n\n:::\n\n```{.r .cell-code}\nhist(escala2$Unaided)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(escala2$Aided1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  escala2$Aided1\nW = 0.92852, p-value = 0.4335\n```\n\n\n:::\n\n```{.r .cell-code}\nhist(escala2$Aided1)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-13-2.png){width=672}\n:::\n:::\n\n\nH0 = apresenta normalidade Normalidade okay (p-valor \\> 0,05, ou seja, aceita H0)\n\n#### Variância\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvar.test(escala2$Unaided, escala2$Aided1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tF test to compare two variances\n\ndata:  escala2$Unaided and escala2$Aided1\nF = 20.978, num df = 9, denom df = 9, p-value = 0.000106\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n  5.210754 84.459185\nsample estimates:\nratio of variances \n          20.97847 \n```\n\n\n:::\n:::\n\n\nH0 = variâncias são homogêneas.\n\nVariâncias são heterogêneas (p-value \\< 0,05, rejeita H0)\n\n# Teste não paramétrico\n\nHouve uma modificação nos dados (Escala) para que fiquem não paramétricos.\n\n#### Visualização\n\n\n::: {.cell}\n\n```{.r .cell-code}\nescala <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1729131173\")\n\nescala |> \n  ggplot(aes(assessment, acuracia))+\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n#### Teste de normalidade\n\n\n::: {.cell}\n\n```{.r .cell-code}\nescala2 <- escala |> \n  select(assessment, rater, acuracia) |> \n  pivot_wider(names_from = assessment,\n              values_from = acuracia)\n\n\nshapiro.test(escala2$Unaided)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  escala2$Unaided\nW = 0.7748, p-value = 0.007155\n```\n\n\n:::\n\n```{.r .cell-code}\nhist(escala2$Unaided)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(escala2$Aided1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  escala2$Aided1\nW = 0.92852, p-value = 0.4335\n```\n\n\n:::\n\n```{.r .cell-code}\nhist(escala2$Aided1)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-16-2.png){width=672}\n:::\n:::\n\n\nComo o p-valor é menor que 0,05, rejeita H0, dessa forma, não apresenta normalidade. A partir daí utilizaremos outro teste, equivalente ao Teste T, mas que usa-se para dados não paramétricos.\n\n#### Teste Wilcox\n\nNão precisa verificar as variâncias.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwilcox.test(escala2$Aided1,\n            escala2$Unaided,\n            paired = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon signed rank test with continuity correction\n\ndata:  escala2$Aided1 and escala2$Unaided\nV = 55, p-value = 0.005889\nalternative hypothesis: true location shift is not equal to 0\n```\n\n\n:::\n:::\n\n\nComo o p-valor é menor que 0,05, rejeita H0, dessa forma as médias são diferentes. Ou seja, há um efeito do uso da escala diagramática aumentando a acurácia dos avaliadores.\n\nSe os dados não atenderem as pressimas para análise paramétrica, pode-se usar um teste não paramétrico, ou, fazer a transformação dos dados, para que esses valores transformados possam atender as premissas. Porém, ao se usar os dados transformados, não está usando os dados originais (não está errado, é apenas uma metodologia diferente).\n\nt.test =\\> pareado (paired = \"TRUE\") não-pareado (paired = \"FALSE\" - não precisa porque já assume isso)\n\nvar.test =\\>\\\nvariâncias homogêneas (var.equal = TRUE - não precisa porque já assume isso) variâncias heterogêneas (var.equal = FALSE)\n\nwilcox.test =\\> pareado (paired = TRUE) não-pareado (paired = FALSE) = Mann-Whitney test\n\n# Três ou mais grupos\n\nANOVA: Hipótese alternativa é que pelo menos uma média é diferente das outras. Mas não diz qual média é diferente das outras, para isso, usa o teste de comparação de médias. H0 = as médias não diferem.\n\ntcm = taxa de crescimento micelial\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmicelial <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=959387827\")\n```\n:::\n\n\n#### Visualização\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmicelial |> \n  ggplot(aes(especie, tcm))+\n  geom_jitter(width = 0.01)+\n  stat_summary(\n    geom = \"point\",\n    fun.y = \"mean\",\n    size = 3,\n    color = \"red\"\n  )\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\nVisualmente: parece que a dispersão dos dados é muito grande, dessa forma não parece haver muita diferença entre os grupos.\n\nTeste F: é a razão da variância entre os grupos sobre a variância dentro dos grupos.\n\n# Teste Anova\n\n1º: Ajusta ANOVA 2º: trabalha com resíduos da ANOVA (aplica os testes)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- lm(tcm ~especie, data = micelial)\n\nanova(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: tcm\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nespecie    4 1.46958 0.36739  19.629 2.028e-07 ***\nResiduals 25 0.46792 0.01872                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = tcm ~ especie, data = micelial)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.23667 -0.09667  0.01583  0.08833  0.28333 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  1.57167    0.05585  28.140  < 2e-16 ***\nespecieFaus -0.33500    0.07899  -4.241 0.000266 ***\nespecieFcor -0.25000    0.07899  -3.165 0.004047 ** \nespecieFgra -0.66000    0.07899  -8.356 1.05e-08 ***\nespecieFmer -0.14500    0.07899  -1.836 0.078317 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1368 on 25 degrees of freedom\nMultiple R-squared:  0.7585,\tAdjusted R-squared:  0.7199 \nF-statistic: 19.63 on 4 and 25 DF,  p-value: 2.028e-07\n```\n\n\n:::\n:::\n\n\nDF = grau de liberdade Sum Sq = é a soma dos quadrados Mean SQ = média da soma dos quadrados (variância) F value (valor F) = variância da espécie/média de residuals Quanto maior o F, menor o p-valor\n\nComo p-valor \\> ou = 0,05 (0,055), não descartamos H0, ou seja, não a diferença entre as médias. Ou seja, não há diferença entre o crescimento micelial das espécies.\n\nPara retirar o intercepto e dar os valores médios direto\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- lm(tcm ~especie -1, data = micelial)\n\nanova(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: tcm\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nespecie    5 51.677 10.3354   552.2 < 2.2e-16 ***\nResiduals 25  0.468  0.0187                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = tcm ~ especie - 1, data = micelial)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.23667 -0.09667  0.01583  0.08833  0.28333 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \nespecieFasi  1.57167    0.05585   28.14  < 2e-16 ***\nespecieFaus  1.23667    0.05585   22.14  < 2e-16 ***\nespecieFcor  1.32167    0.05585   23.66  < 2e-16 ***\nespecieFgra  0.91167    0.05585   16.32 7.66e-15 ***\nespecieFmer  1.42667    0.05585   25.54  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1368 on 25 degrees of freedom\nMultiple R-squared:  0.991,\tAdjusted R-squared:  0.9892 \nF-statistic: 552.2 on 5 and 25 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\nPara ter variabilidade, modificamos os dados, para ter efeito de espécie.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmicelial <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=959387827\")\n\nmicelial |> \n  ggplot(aes(especie, tcm))+\n  geom_jitter(width = 0.01)+\n  stat_summary(\n    geom = \"point\",\n    fun.y = \"mean\",\n    size = 3,\n    color = \"red\"\n  )\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n#### Teste Anova (com dados alterados)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- lm(tcm ~especie, data = micelial)\n\nanova(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: tcm\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nespecie    4 1.46958 0.36739  19.629 2.028e-07 ***\nResiduals 25 0.46792 0.01872                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(m1) #<- visualiza a diferença entre os grupos\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = tcm ~ especie, data = micelial)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.23667 -0.09667  0.01583  0.08833  0.28333 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  1.57167    0.05585  28.140  < 2e-16 ***\nespecieFaus -0.33500    0.07899  -4.241 0.000266 ***\nespecieFcor -0.25000    0.07899  -3.165 0.004047 ** \nespecieFgra -0.66000    0.07899  -8.356 1.05e-08 ***\nespecieFmer -0.14500    0.07899  -1.836 0.078317 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1368 on 25 degrees of freedom\nMultiple R-squared:  0.7585,\tAdjusted R-squared:  0.7199 \nF-statistic: 19.63 on 4 and 25 DF,  p-value: 2.028e-07\n```\n\n\n:::\n:::\n\n\nComo valor-p foi menor que 0,05 (2.028e-07), rejeitamos H0, dessa forma, pelo menos uma espécie difere das outras.\n\n-   o summary compara a média de todos com asiaticus (intercepto) e não de todos contra todos.\n\n## Para verificar a diferença entre as médias\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedias1 <- emmeans(m1, ~especie)\n\nlibrary(multcomp)\nlibrary(multcompView) #para colocar as letrinhas\ncld(medias1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n especie emmean     SE df lower.CL upper.CL .group\n Fgra     0.912 0.0559 25    0.797     1.03  1    \n Faus     1.237 0.0559 25    1.122     1.35   2   \n Fcor     1.322 0.0559 25    1.207     1.44   2   \n Fmer     1.427 0.0559 25    1.312     1.54   23  \n Fasi     1.572 0.0559 25    1.457     1.69    3  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 5 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n:::\n\n\n#### Verificando as premissas\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Para verificar normalidade:\nhist(m1$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(m1$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  m1$residuals\nW = 0.9821, p-value = 0.8782\n```\n\n\n:::\n\n```{.r .cell-code}\n#Para verificar as variâncias:\nbartlett.test(tcm ~especie, data = micelial)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  tcm by especie\nBartlett's K-squared = 4.4367, df = 4, p-value = 0.3501\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(DHARMa)\nplot(simulateResiduals(m1))\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-25-2.png){width=672}\n:::\n\n```{.r .cell-code}\nlibrary(performance)\ncheck_normality(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: residuals appear as normally distributed (p = 0.878).\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m1) #(variâncias homogêneas = homoscedastic)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: Error variance appears to be homoscedastic (p = 0.880).\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_model(m1)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-25-3.png){width=672}\n:::\n:::\n\n\n# Aula 7\n\n## Importação dos dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninseticida <- InsectSprays\n\ninseticida |> \n  count(spray)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  spray  n\n1     A 12\n2     B 12\n3     C 12\n4     D 12\n5     E 12\n6     F 12\n```\n\n\n:::\n:::\n\n\n12 repetições para cada spray. tem um fator só (inseticida = spray) -\\> vai ser Anova unifatorial (um fator só com seis níveis).\n\n### Visualização\n\nVer se tem normalidade dos resíduos e homogeneidade entre as variâncias.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninseticida |> \n  ggplot(aes(spray, count))+\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\nF é o que tem maior variância, o que tem menor é o C e D (tem outlier), parece que (visualmente) as variâncias não são homogêneas.\n\n1º Ajusta ANOVA 2º trabalha com resíduos da ANOVA (aplica os testes)\n\n`lm` = função que ajusta anova\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- lm(count ~ spray,\n         data = inseticida)\n\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = count ~ spray, data = inseticida)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-8.333 -1.958 -0.500  1.667  9.333 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  14.5000     1.1322  12.807  < 2e-16 ***\nsprayB        0.8333     1.6011   0.520    0.604    \nsprayC      -12.4167     1.6011  -7.755 7.27e-11 ***\nsprayD       -9.5833     1.6011  -5.985 9.82e-08 ***\nsprayE      -11.0000     1.6011  -6.870 2.75e-09 ***\nsprayF        2.1667     1.6011   1.353    0.181    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.922 on 66 degrees of freedom\nMultiple R-squared:  0.7244,\tAdjusted R-squared:  0.7036 \nF-statistic:  34.7 on 5 and 66 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nanova(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: count\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nspray      5 2668.8  533.77  34.702 < 2.2e-16 ***\nResiduals 66 1015.2   15.38                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nhist(m1$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(m1$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  m1$residuals\nW = 0.96006, p-value = 0.02226\n```\n\n\n:::\n\n```{.r .cell-code}\nqqnorm(m1$residuals)\nqqline(m1$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-28-2.png){width=672}\n:::\n\n```{.r .cell-code}\nbartlett.test(count ~ spray,\n             data = inseticida)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  count by spray\nBartlett's K-squared = 25.96, df = 5, p-value = 9.085e-05\n```\n\n\n:::\n:::\n\n\nOs resíduos parecem ter normalidade visualizando pelo histograma. AO fazer o shapiro.test, vê-se que não tem normalidade, pq o p-valor \\< 0,05, então rejeita H0 (H0 = normalidade).\n\nMais grave: variâncias não serem homogêneas, do que normalidade não ser atendida.ANOVA é um teste mais robusto à falta de normalidade do que à heterocedasticidade.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(performance)\ncheck_normality(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nWarning: Non-normality of residuals detected (p = 0.022).\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p < .001).\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(DHARMa)\nplot(simulateResiduals(m1))\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\nCom ***performance*** e **DHARma**, foi possível ver que não tem normalidade e que as variâncias são heterogêneas. O DHARma faz o outro test (KS test) -- saída das variâncias com texto em vermelho indica que as variâncias são heterogêneas.\n\nTranformações mais comuns: log de x (quando tem valor igual a 0, adiciona-se uma constante, por exemplo, +0,5), raiz quadrada de x, arc seno de x\n\n# Premissas não atendidas\n\n### Alternativa 1: fazer a transformação dos dados\n\nNormalmente, quando tem contagem (numérica discreta), raiz quadrada resolve.\n\nFunção `sqrt` faz a raiz quadrada.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninseticida <- inseticida |> \n  mutate(count2 = sqrt(count))\n\ninseticida |> \n  ggplot(aes(spray, count2))+\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n\nAgora, variancias parecem mais iguais, dessa forma, visualmente parece que a raiz quadrada está homogeneizando as variâncias.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm2 <- lm(count2 ~ spray,\n         data = inseticida)\n\nsummary(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = count2 ~ spray, data = inseticida)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.24486 -0.39970 -0.01902  0.42661  1.40089 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   3.7607     0.1814  20.733  < 2e-16 ***\nsprayB        0.1160     0.2565   0.452    0.653    \nsprayC       -2.5158     0.2565  -9.807 1.64e-14 ***\nsprayD       -1.5963     0.2565  -6.223 3.80e-08 ***\nsprayE       -1.9512     0.2565  -7.606 1.34e-10 ***\nsprayF        0.2579     0.2565   1.006    0.318    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.6283 on 66 degrees of freedom\nMultiple R-squared:  0.7724,\tAdjusted R-squared:  0.7552 \nF-statistic:  44.8 on 5 and 66 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nanova(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: count2\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nspray      5 88.438 17.6876  44.799 < 2.2e-16 ***\nResiduals 66 26.058  0.3948                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nhist(m2$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(m2$residuals)  # tem normalidade\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  m2$residuals\nW = 0.98721, p-value = 0.6814\n```\n\n\n:::\n\n```{.r .cell-code}\nqqnorm(m2$residuals)\nqqline(m2$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-31-2.png){width=672}\n:::\n\n```{.r .cell-code}\nbartlett.test(count2 ~spray,\n             data = inseticida)  # tem homgeneidade das variâncias\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  count2 by spray\nBartlett's K-squared = 3.7525, df = 5, p-value = 0.5856\n```\n\n\n:::\n:::\n\n\nCom a transformação alcançou a normalidade e homogeneidade de variancias. Em ***anova(m2)*** pode ver que pelo menos um grupo difere dos demais (p-valor \\< 0,05)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(performance)\ncheck_normality(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: residuals appear as normally distributed (p = 0.681).\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: Error variance appears to be homoscedastic (p = 0.854).\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(DHARMa)\nplot(simulateResiduals(m2)) #melhorou ainda mais a normmalidade e variância deu ñ significativo\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n\nQuando for avaliar, utilizar os diferentes testes para garantir confiabilidade. ANOVa é um teste mais robusto à falta de normalidade do que à heterocedasticidade.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Para m1 (dados não transformados)\nlibrary(emmeans)\nm1_medias <- emmeans(m1, ~ spray,)\nplot(m1_medias)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-33-1.png){width=672}\n:::\n\n```{.r .cell-code}\nlibrary(multcomp)\ncld(m1_medias)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n spray emmean   SE df lower.CL upper.CL .group\n C       2.08 1.13 66   -0.177     4.34  1    \n E       3.50 1.13 66    1.240     5.76  1    \n D       4.92 1.13 66    2.656     7.18  1    \n A      14.50 1.13 66   12.240    16.76   2   \n B      15.33 1.13 66   13.073    17.59   2   \n F      16.67 1.13 66   14.406    18.93   2   \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n\n```{.r .cell-code}\n# Para m2 (dados transformados)\nlibrary(emmeans)\nm2_medias <- emmeans(m2, ~ spray,)\nplot(m2_medias)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-33-2.png){width=672}\n:::\n\n```{.r .cell-code}\nlibrary(multcomp)\ncld(m2_medias)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n spray emmean    SE df lower.CL upper.CL .group\n C       1.24 0.181 66    0.883     1.61  1    \n E       1.81 0.181 66    1.447     2.17  12   \n D       2.16 0.181 66    1.802     2.53   2   \n A       3.76 0.181 66    3.399     4.12    3  \n B       3.88 0.181 66    3.514     4.24    3  \n F       4.02 0.181 66    3.656     4.38    3  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n\n```{.r .cell-code}\npwpm(m2_medias)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       A      B      C      D      E      F\nA [3.76] 0.9975 <.0001 <.0001 <.0001 0.9145\nB -0.116 [3.88] <.0001 <.0001 <.0001 0.9936\nC  2.516  2.632 [1.24] 0.0081 0.2513 <.0001\nD  1.596  1.712 -0.919 [2.16] 0.7366 <.0001\nE  1.951  2.067 -0.565  0.355 [1.81] <.0001\nF -0.258 -0.142 -2.774 -1.854 -2.209 [4.02]\n\nRow and column labels: spray\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n\n\n:::\n\n```{.r .cell-code}\npwpp(m2_medias)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-33-3.png){width=672}\n:::\n\n```{.r .cell-code}\npairs(m2_medias)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n contrast estimate    SE df t.ratio p.value\n A - B      -0.116 0.257 66  -0.452  0.9975\n A - C       2.516 0.257 66   9.807  <.0001\n A - D       1.596 0.257 66   6.223  <.0001\n A - E       1.951 0.257 66   7.606  <.0001\n A - F      -0.258 0.257 66  -1.006  0.9145\n B - C       2.632 0.257 66  10.259  <.0001\n B - D       1.712 0.257 66   6.675  <.0001\n B - E       2.067 0.257 66   8.058  <.0001\n B - F      -0.142 0.257 66  -0.554  0.9936\n C - D      -0.919 0.257 66  -3.584  0.0081\n C - E      -0.565 0.257 66  -2.201  0.2513\n C - F      -2.774 0.257 66 -10.813  <.0001\n D - E       0.355 0.257 66   1.383  0.7366\n D - F      -1.854 0.257 66  -7.229  <.0001\n E - F      -2.209 0.257 66  -8.612  <.0001\n\nP value adjustment: tukey method for comparing a family of 6 estimates \n```\n\n\n:::\n\n```{.r .cell-code}\n# quando usa os dados não transformados tá cometendo o erro do tipo 2, não estava mostrando a diferença quando existia (mostrou só 2 grupos e quando com dados transformados dividiu em 3)\n```\n:::\n\n\nUtilizando o pwpm mostrou a comparação entre cada um dos grupos (comparação par a par). Quando o valor (é igual ao p-valor) é \\< 0,05, diz que são de grupos diferentes (rejeita H0), enquanto valor \\> 0,05, pertencem ao mesmo grupo (não rejeita H0).\n\n#### Testando outras formas de transformação: box\n\nBox-Cox: y(lambda) = (x\\^lambda -1)/lambda lambda é o valor de x onde o y é máximo Sempre que o lambda = 0,5 é igual a raiz quadrado\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(MASS)\nb <- boxcox(lm(inseticida$count+0.1 ~1))\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n\n```{.r .cell-code}\nlambda <- b$x[which.max(b$y)]\n\n# O lambda (0,42) é o que usaremos na fórmula para transformar os dados --> variável transformada\n\n#Usando o lambda (0,42) na fórmula: y(lambda) = (x^lambda -1)/lambda\ninseticida$count3 <- (inseticida$count ^ lambda - 1) / lambda\n\nm5 <- lm(count3 ~ spray,\n         data = inseticida)\n\nsummary(m5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = count3 ~ spray, data = inseticida)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-2.74114 -0.65893 -0.01922  0.78560  2.64047 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   4.8835     0.3232  15.109  < 2e-16 ***\nsprayB        0.1910     0.4571   0.418    0.677    \nsprayC       -4.4995     0.4571  -9.843 1.42e-14 ***\nsprayD       -2.7157     0.4571  -5.941 1.17e-07 ***\nsprayE       -3.3605     0.4571  -7.352 3.82e-10 ***\nsprayF        0.4162     0.4571   0.911    0.366    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.12 on 66 degrees of freedom\nMultiple R-squared:  0.7659,\tAdjusted R-squared:  0.7482 \nF-statistic: 43.19 on 5 and 66 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nanova(m5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: count3\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nspray      5 270.737  54.147  43.191 < 2.2e-16 ***\nResiduals 66  82.742   1.254                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nhist(m5$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-34-2.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(m5$residuals)  \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  m5$residuals\nW = 0.98873, p-value = 0.7723\n```\n\n\n:::\n\n```{.r .cell-code}\nqqnorm(m5$residuals)\nqqline(m5$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-34-3.png){width=672}\n:::\n\n```{.r .cell-code}\nbartlett.test(count3 ~spray,\n             data = inseticida)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  count3 by spray\nBartlett's K-squared = 5.7412, df = 5, p-value = 0.3322\n```\n\n\n:::\n\n```{.r .cell-code}\n# é uma forma de estabilizar variância também\n```\n:::\n\n\n### Alternativa 2: teste não paramétrico: Kruskal test\n\nUsa saída original (sem transformar). Faz um rankeamento. Utiliza o teste Kruskal-wallis. Nele, H0 = médias são iguais. Quando rejeita H0 (p-valor menor que 0,05) pelo menos uma média difere das demais.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(agricolae)\n\nkruskal.test(count ~spray,\n             data = inseticida) #kruskal.test é do R base\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  count by spray\nKruskal-Wallis chi-squared = 54.691, df = 5, p-value = 1.511e-10\n```\n\n\n:::\n\n```{.r .cell-code}\n# usando o agricolae\nm3 <- kruskal(inseticida$count,\n        inseticida$spray,\n        group = TRUE)\n```\n:::\n\n\nH0 = médias são iguais Como Kruskal-wallis, rejeita H0, então as médias são diferentes\n\nO não-paramétrico deu os mesmos resultados dos valores transformados.\n\nmodelo linear generalizado = glm. É o modelo menos criticado (entre os transformado e não-paramétrico). Utiliza a distribuição apropriado.\n\n### Alternativa 3: GLMs\n\nModelos lineares generalizados é o modelo menos criticado (entre a transformação dos dados e o uso de não paramétricos). Utiliza a distribuição apropriada para os dados. Exemplo, para dados contagem (numérica discreta): a distribuição de Poisson se ajusta bem a essa distribuição (de 0 para cima).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# glm com a familia gaussiana reduz a lm\nm4 <- glm(count ~ spray,\n          family = gaussian,\n          data = inseticida)\n\n# utilizando com a família poisson\nm4 <- glm(count ~ spray,\n          family = poisson,\n          data = inseticida)\nsummary(m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = count ~ spray, family = poisson, data = inseticida)\n\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  2.67415    0.07581  35.274  < 2e-16 ***\nsprayB       0.05588    0.10574   0.528    0.597    \nsprayC      -1.94018    0.21389  -9.071  < 2e-16 ***\nsprayD      -1.08152    0.15065  -7.179 7.03e-13 ***\nsprayE      -1.42139    0.17192  -8.268  < 2e-16 ***\nsprayF       0.13926    0.10367   1.343    0.179    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 409.041  on 71  degrees of freedom\nResidual deviance:  98.329  on 66  degrees of freedom\nAIC: 376.59\n\nNumber of Fisher Scoring iterations: 5\n```\n\n\n:::\n\n```{.r .cell-code}\nanova(m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Deviance Table\n\nModel: poisson, link: log\n\nResponse: count\n\nTerms added sequentially (first to last)\n\n      Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    \nNULL                     71     409.04              \nspray  5   310.71        66      98.33 < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(car)\nAnova(m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Deviance Table (Type II tests)\n\nResponse: count\n      LR Chisq Df Pr(>Chisq)    \nspray   310.71  5  < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(simulateResiduals(m4))\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-36-1.png){width=672}\n:::\n\n```{.r .cell-code}\nm4_medias <- emmeans(m4, ~spray,\n                     type = \"response\")\n\ncld(m4_medias)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n spray  rate    SE  df asymp.LCL asymp.UCL .group\n C      2.08 0.417 Inf      1.41      3.08  1    \n E      3.50 0.540 Inf      2.59      4.74  12   \n D      4.92 0.640 Inf      3.81      6.35   2   \n A     14.50 1.099 Inf     12.50     16.82    3  \n B     15.33 1.130 Inf     13.27     17.72    3  \n F     16.67 1.179 Inf     14.51     19.14    3  \n\nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \nP value adjustment: tukey method for comparing a family of 6 estimates \nTests are performed on the log scale \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n:::\n\n\nAnova: tem um que é diferente dos outros (p-valor maior ou igual a 0,05). Os grupos com o GLM foram iguais às outras alternativas (dados transformados e não-paramétrico)\n\n# Anova 2 fatores = Modelo fatorial (two-way anova)\n\nQuando tem interação significativa entre os fatores tem que se estimar as médias de um dentro do outro (combinação dos fatores). Letras maiúsculas comparam as colunas e as minusculas comparam as linhas.\n\n## Importa os dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntheme_set(theme_bw())\nli <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=2023059672\")\n\n#visualização dos dados\n\nli |> \n  ggplot(aes(factor(dose), severity, color = factor(dose)))+\n  geom_jitter(width = 0.05)+\n  facet_wrap(~~treat)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-37-1.png){width=672}\n:::\n\n```{.r .cell-code}\nli |> \n  ggplot(aes(factor(treat), severity, color = factor(dose)))+\n  geom_jitter(width = 0.05)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-37-2.png){width=672}\n:::\n:::\n\n\n## Anova\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmf <- lm(severity ~treat*factor(dose),\n         data = li)\n\nanova(mf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: severity\n                   Df   Sum Sq  Mean Sq F value    Pr(>F)    \ntreat               1 0.113232 0.113232  30.358 4.754e-05 ***\nfactor(dose)        1 0.073683 0.073683  19.755 0.0004077 ***\ntreat:factor(dose)  1 0.072739 0.072739  19.502 0.0004326 ***\nResiduals          16 0.059678 0.003730                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\ntreat:dose = interação\n\nInteração significativa: tem que estimar as médias de um dentro do outro (combinação dos fatores). São quatro valores médios (LI-0,5, LI-2,0, TEB-0,5 e TEB-2,0 = 4 médias). Letras maiusculas comparam as colunas e as minusculas comparam as linhas\n\nEXEMPLO:\n\n![](images/1.png)\n\n### Testar as premissas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(simulateResiduals(mf))\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-39-1.png){width=672}\n:::\n:::\n\n\nDharma: não teve problema na normalidade dos residuals, nem na heterocedasticidade\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_heteroscedasticity(mf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p < .001).\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_homogeneity(mf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nWarning: Variances differ between groups (Bartlett Test, p = 0.001).\n```\n\n\n:::\n:::\n\n\nUtilizando o performance, os resultados foram o contrário do DHArma, mas o Dharma é mais confiável, então vamos prosseguir.\n\n### COMPARAR AS COLUNAS\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmf_medias <- emmeans(mf, ~ treat | dose)\ncld(mf_medias)  #para mostrar os grupos\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ndose = 0.5:\n treat        emmean     SE df lower.CL upper.CL .group\n Tebuconazole 0.0210 0.0273 16 -0.03690   0.0789  1    \n Ionic liquid 0.2921 0.0273 16  0.23420   0.3500   2   \n\ndose = 2.0:\n treat        emmean     SE df lower.CL upper.CL .group\n Tebuconazole 0.0202 0.0273 16 -0.03768   0.0781  1    \n Ionic liquid 0.0501 0.0273 16 -0.00781   0.1080  1    \n\nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n:::\n\n\n![](images/2.png)\n\n### COMPARAR AS LINHAS\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmf_medias <- emmeans(mf, ~ dose | treat)\ncld(mf_medias)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntreat = Ionic liquid:\n dose emmean     SE df lower.CL upper.CL .group\n  2.0 0.0501 0.0273 16 -0.00781   0.1080  1    \n  0.5 0.2921 0.0273 16  0.23420   0.3500   2   \n\ntreat = Tebuconazole:\n dose emmean     SE df lower.CL upper.CL .group\n  2.0 0.0202 0.0273 16 -0.03768   0.0781  1    \n  0.5 0.0210 0.0273 16 -0.03690   0.0789  1    \n\nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n:::\n\n\n![](images/3.png)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}