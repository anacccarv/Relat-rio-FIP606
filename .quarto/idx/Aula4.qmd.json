{"title":"Aula4","markdown":{"yaml":{"title":"Aula4","format":"html","editor":"visual","message":false,"warning":false},"headingText":"Bibliotecas","containsRefs":false,"markdown":"\n\n\n```{r}\nlibrary(datapasta)\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(ggthemes)\nlibrary(gsheet)\n```\n\n# Importação de dados\n\nUso do pacote **datapasta** para importar dados (vetores, tabelas) para dentro do R:\n\nCopiar dados da internet -\\> Addins -\\> ***paste as tribble***\n\nSite: <https://escritacientifica.sc.usp.br/estatisticas/estatisticas-por-paises/>\n\n```{r}\nvisitas <- tibble::tribble(\n             ~V1,              ~V2, ~V3,\n              1L,        \"Uruguay\",  1L,\n              2L,    \"Timor-Leste\",  1L,\n              3L,      \"Singapore\",  1L,\n              4L,         \"Poland\",  1L,\n              5L,       \"Pakistan\",  1L,\n              6L,       \"Malaysia\",  1L,\n              7L,          \"Italy\",  1L,\n              8L,          \"India\",  1L,\n              9L,        \"Finland\",  1L,\n             10L,          \"Egypt\",  1L,\n             11L,          \"China\",  1L,\n             12L,     \"Cape Verde\",  1L,\n             13L,        \"Bolivia\",  1L,\n             14L,        \"Austria\",  1L,\n             15L,      \"Argentina\",  1L,\n             16L,           \"Peru\",  2L,\n             17L,       \"Paraguay\",  2L,\n             18L,          \"Chile\",  2L,\n             19L,         \"France\",  3L,\n             20L,        \"Ecuador\",  3L,\n             21L,    \"Netherlands\",  4L,\n             22L, \"United Kingdom\",  5L,\n             23L,        \"Hungary\",  5L,\n             24L,        \"Germany\",  5L,\n             25L,       \"Colombia\",  8L,\n             26L,      \"(not set)\", 12L,\n             27L,          \"Spain\", 16L,\n             28L,         \"Angola\", 19L,\n             29L,  \"United States\", 23L,\n             30L,       \"Portugal\", 33L,\n             31L,     \"Mozambique\", 43L,\n            32L, \"Brazil\", 4303L\n             )\n\n```\n\n**pak** é um pacote que instala pacotes de outros repositórios além do CRAN\n\n```{r}\n#install.packages(\"pak\")\n#pak::pkg_install(\"Icens\")\n#pak::pkg_install(\"emdelponte/r4pde\")\n```\n\n# Importação dos dados\n\nConjunto de dados do site R4PDE (\"https://r4pde.net/temporal-fitting\")\n\n```{r}\npepper <- \n  tribble(\n   ~t,  ~`1`,  ~`2`,  ~`3`,\n   0,  0.08, 0.001, 0.001,\n   7,  0.13,  0.01, 0.001,\n  14,  0.78,  0.09,  0.01,\n  21,  0.92,  0.25,  0.05,\n  28,  0.99,   0.8,  0.18,\n  35, 0.995,  0.98,  0.34,\n  42, 0.999,  0.99,  0.48,\n  49, 0.999, 0.999,  0.74\n  )\n```\n\n## Mudando o formato da tabela\n\nPara permitir a visualização dos dados através do ggplot é importante que os dados estejam no formato correto. A função ***pivot_longer*** permite passar uma tabela que está no formato largo para o formato longo. De igual modo, a função ***pivot_wider*** permite transformar a tabela do formato longo para formato largo.\n\n```{r}\npepper1 <- pepper |> \n  pivot_longer(2:4,\n               names_to = \"epidemic\",\n               values_to = \"inc\")\n```\n\n## Visualização dos dados\n\nAgora com os dados transformados é possível visualizar no **ggplot**.\n\nVamos utilizar a função ***annotate*** para colocar informações no gráfico (etiquetas, equações...).\n\nComo já temos os nº das linhas dentro do próprio gráfico não precisa da legenda, por isso **legend.position = \"none\",** para tirar a legenda.\n\n```{r}\npepper1 |> \n  ggplot(aes(t, inc, color = epidemic))+\n  geom_point()+\n  geom_line()+\n  annotate(geom = \"text\", x = 12.5, y = 0.80, label = 1)+\n  annotate(geom = \"text\", x = 26, y = 0.80, label = 2)+\n  annotate(geom = \"text\", x = 41, y = 0.50, label = 3)+\n  theme(legend.position = \"none\")\n\n\n```\n\n# Tabela de contingência\n\n## Importação dos dados\n\n```{r}\ncr <- read_csv(\"https://raw.githubusercontent.com/emdelponte/paper-coffee-rust-Ethiopia/master/data/survey_clean.csv\")\n\n```\n\n## Esquematizando a tabela\n\nVai fazer uma contagem de uma váriavel categórica (quantas ocorrências tem) através da função ***count***. Função interessante para fazer um sumário de variáveis categóricas de forma rápida.\n\nTambém podemos usar a função tabyl do pacote **janitor** para fazer a contagem - cruzando as variaveis (ex: zone e region) temos a tabela de contigência.\n\nAs **tabelas de contingência** de frequências relativas mostram que porcentagem dos dados se encaixa em cada categoria.\n\n```{r}\ncr |> \n  count(region, zone)\n  \ncr |> \n  tabyl(zone, region)\n\ncr |> \n  tabyl(cultivar, region)\n\ncr |> \n  tabyl(cultivar, farm_management) #formato largo\n\n  #formato longo, estes que usaremos para fazer gráficos com o ggplot:\n\ncr2 <- cr |> \n  count(farm_management, cultivar)\n```\n\n## Visualização dos dados com ggplot\n\n```{r}\ncr2 |> \n    ggplot(aes(cultivar, n, fill = farm_management, label = n))+\n  geom_col(position = \"dodge2\")+\n  scale_fill_canva()+\n  theme_bw()+\n  theme(strip.text.x = element_blank(),\n      legend.position = \"top\")+\n    geom_text(position = position_dodge(width = 0.9))+\n  facet_wrap(~cultivar, scale = \"free_x\")\n  \n\n```\n\n## \n\n```{r}\nmg <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1aID5Dh6PlBVCKzU1j7k-WA6zuWQWE2NhtWEgdJtt5iA/edit?usp=sharing\")\n\n# Com as barras podemos ver o valor médio\nmg |> \n  group_by(trat) |>\n  summarise(mean_comp = mean(comp)) |> \n  ggplot(aes(trat, mean_comp))+\n  geom_col(fill = \"steelblue\", width = 0.5)\n\n#Com o jitter podemos ver a dispersão dos dados já que cada ponto é referente a uma observação.  \nmg |> \n  ggplot(aes(trat, comp))+\n  geom_jitter(width = 0.1)\n\nmg |> \n  group_by(trat) |>\n  summarise(mean_comp = mean(comp),\n            sd_comp = sd(comp)) |> \n  ggplot(aes(trat, mean_comp))+\n  #geom_col(fill = \"steelblue\", width = 0.5)+\n  geom_point(size = 3)+\n  ylim(4, 20)+\n  geom_errorbar(aes(ymin = mean_comp - sd_comp,\n                    ymax = mean_comp + sd_comp),\n                width = 0.05)+\n  annotate(geom = \"text\",\n           x = 1, y = 17.5,\n           label = \"*\")\n\n# quando é grafico de contagem de elementos tem que começar do 0. Nesse caso o y começou do 5 pq é para dar noçao melhor dos valores. Se for com o geom_col tem que começar do 0.\n```\n","srcMarkdownNoYaml":"\n\n# Bibliotecas\n\n```{r}\nlibrary(datapasta)\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(ggthemes)\nlibrary(gsheet)\n```\n\n# Importação de dados\n\nUso do pacote **datapasta** para importar dados (vetores, tabelas) para dentro do R:\n\nCopiar dados da internet -\\> Addins -\\> ***paste as tribble***\n\nSite: <https://escritacientifica.sc.usp.br/estatisticas/estatisticas-por-paises/>\n\n```{r}\nvisitas <- tibble::tribble(\n             ~V1,              ~V2, ~V3,\n              1L,        \"Uruguay\",  1L,\n              2L,    \"Timor-Leste\",  1L,\n              3L,      \"Singapore\",  1L,\n              4L,         \"Poland\",  1L,\n              5L,       \"Pakistan\",  1L,\n              6L,       \"Malaysia\",  1L,\n              7L,          \"Italy\",  1L,\n              8L,          \"India\",  1L,\n              9L,        \"Finland\",  1L,\n             10L,          \"Egypt\",  1L,\n             11L,          \"China\",  1L,\n             12L,     \"Cape Verde\",  1L,\n             13L,        \"Bolivia\",  1L,\n             14L,        \"Austria\",  1L,\n             15L,      \"Argentina\",  1L,\n             16L,           \"Peru\",  2L,\n             17L,       \"Paraguay\",  2L,\n             18L,          \"Chile\",  2L,\n             19L,         \"France\",  3L,\n             20L,        \"Ecuador\",  3L,\n             21L,    \"Netherlands\",  4L,\n             22L, \"United Kingdom\",  5L,\n             23L,        \"Hungary\",  5L,\n             24L,        \"Germany\",  5L,\n             25L,       \"Colombia\",  8L,\n             26L,      \"(not set)\", 12L,\n             27L,          \"Spain\", 16L,\n             28L,         \"Angola\", 19L,\n             29L,  \"United States\", 23L,\n             30L,       \"Portugal\", 33L,\n             31L,     \"Mozambique\", 43L,\n            32L, \"Brazil\", 4303L\n             )\n\n```\n\n**pak** é um pacote que instala pacotes de outros repositórios além do CRAN\n\n```{r}\n#install.packages(\"pak\")\n#pak::pkg_install(\"Icens\")\n#pak::pkg_install(\"emdelponte/r4pde\")\n```\n\n# Importação dos dados\n\nConjunto de dados do site R4PDE (\"https://r4pde.net/temporal-fitting\")\n\n```{r}\npepper <- \n  tribble(\n   ~t,  ~`1`,  ~`2`,  ~`3`,\n   0,  0.08, 0.001, 0.001,\n   7,  0.13,  0.01, 0.001,\n  14,  0.78,  0.09,  0.01,\n  21,  0.92,  0.25,  0.05,\n  28,  0.99,   0.8,  0.18,\n  35, 0.995,  0.98,  0.34,\n  42, 0.999,  0.99,  0.48,\n  49, 0.999, 0.999,  0.74\n  )\n```\n\n## Mudando o formato da tabela\n\nPara permitir a visualização dos dados através do ggplot é importante que os dados estejam no formato correto. A função ***pivot_longer*** permite passar uma tabela que está no formato largo para o formato longo. De igual modo, a função ***pivot_wider*** permite transformar a tabela do formato longo para formato largo.\n\n```{r}\npepper1 <- pepper |> \n  pivot_longer(2:4,\n               names_to = \"epidemic\",\n               values_to = \"inc\")\n```\n\n## Visualização dos dados\n\nAgora com os dados transformados é possível visualizar no **ggplot**.\n\nVamos utilizar a função ***annotate*** para colocar informações no gráfico (etiquetas, equações...).\n\nComo já temos os nº das linhas dentro do próprio gráfico não precisa da legenda, por isso **legend.position = \"none\",** para tirar a legenda.\n\n```{r}\npepper1 |> \n  ggplot(aes(t, inc, color = epidemic))+\n  geom_point()+\n  geom_line()+\n  annotate(geom = \"text\", x = 12.5, y = 0.80, label = 1)+\n  annotate(geom = \"text\", x = 26, y = 0.80, label = 2)+\n  annotate(geom = \"text\", x = 41, y = 0.50, label = 3)+\n  theme(legend.position = \"none\")\n\n\n```\n\n# Tabela de contingência\n\n## Importação dos dados\n\n```{r}\ncr <- read_csv(\"https://raw.githubusercontent.com/emdelponte/paper-coffee-rust-Ethiopia/master/data/survey_clean.csv\")\n\n```\n\n## Esquematizando a tabela\n\nVai fazer uma contagem de uma váriavel categórica (quantas ocorrências tem) através da função ***count***. Função interessante para fazer um sumário de variáveis categóricas de forma rápida.\n\nTambém podemos usar a função tabyl do pacote **janitor** para fazer a contagem - cruzando as variaveis (ex: zone e region) temos a tabela de contigência.\n\nAs **tabelas de contingência** de frequências relativas mostram que porcentagem dos dados se encaixa em cada categoria.\n\n```{r}\ncr |> \n  count(region, zone)\n  \ncr |> \n  tabyl(zone, region)\n\ncr |> \n  tabyl(cultivar, region)\n\ncr |> \n  tabyl(cultivar, farm_management) #formato largo\n\n  #formato longo, estes que usaremos para fazer gráficos com o ggplot:\n\ncr2 <- cr |> \n  count(farm_management, cultivar)\n```\n\n## Visualização dos dados com ggplot\n\n```{r}\ncr2 |> \n    ggplot(aes(cultivar, n, fill = farm_management, label = n))+\n  geom_col(position = \"dodge2\")+\n  scale_fill_canva()+\n  theme_bw()+\n  theme(strip.text.x = element_blank(),\n      legend.position = \"top\")+\n    geom_text(position = position_dodge(width = 0.9))+\n  facet_wrap(~cultivar, scale = \"free_x\")\n  \n\n```\n\n## \n\n```{r}\nmg <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1aID5Dh6PlBVCKzU1j7k-WA6zuWQWE2NhtWEgdJtt5iA/edit?usp=sharing\")\n\n# Com as barras podemos ver o valor médio\nmg |> \n  group_by(trat) |>\n  summarise(mean_comp = mean(comp)) |> \n  ggplot(aes(trat, mean_comp))+\n  geom_col(fill = \"steelblue\", width = 0.5)\n\n#Com o jitter podemos ver a dispersão dos dados já que cada ponto é referente a uma observação.  \nmg |> \n  ggplot(aes(trat, comp))+\n  geom_jitter(width = 0.1)\n\nmg |> \n  group_by(trat) |>\n  summarise(mean_comp = mean(comp),\n            sd_comp = sd(comp)) |> \n  ggplot(aes(trat, mean_comp))+\n  #geom_col(fill = \"steelblue\", width = 0.5)+\n  geom_point(size = 3)+\n  ylim(4, 20)+\n  geom_errorbar(aes(ymin = mean_comp - sd_comp,\n                    ymax = mean_comp + sd_comp),\n                width = 0.05)+\n  annotate(geom = \"text\",\n           x = 1, y = 17.5,\n           label = \"*\")\n\n# quando é grafico de contagem de elementos tem que começar do 0. Nesse caso o y começou do 5 pq é para dar noçao melhor dos valores. Se for com o geom_col tem que começar do 0.\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"Aula4.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.555","editor":"visual","theme":{"light":"Minty","dark":"superhero"},"title":"Aula4","message":false},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}